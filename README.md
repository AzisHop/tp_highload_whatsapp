# tp_highload_whatsapp

# 1. Тема и целевая аудитория

### Тема
WhatsApp — популярная бесплатная система мгновенного обмена текстовыми сообщениями для мобильных и иных платформ с поддержкой голосовой связи и видеосвязи.

### Функционал MVP

- Классический чат
- Групповой чат
- Мобильная и декстопная версия приложения

### Целевая аудитория
Статистика пользователей WhatsApp показывает 2 миллиарда пользователей, что делает платформу первой по популярности в списке приложений данного типа в мире [[1]](https://99firms.com/blog/whatsapp-statistics/).

WhatsApp используется в более, чем 109 странах. Наибольший спрос отмечается в Индии, Бразилии, Мексике, России и многих других странах, расположенных в Европе, Азии, Южной Америке, Африке и Океании.

Таблица 1. Уровень проникновения среди пользователей по возрасту [[2]](https://www.statista.com/statistics/814649/whatsapp-users-in-the-united-states-by-age/)

Возрастная группа | Процентное соотношение
------------ | -------------
15-25 | 19%
26-35 | 27% 
36-45 | 20% 
46-55 | 17% 
56+ | 13% 

# 2. Расчёт нагрузки

### Продуктовые метрики

- **Ежемесячная аудитория** - 2 млрд. чел [[1]](https://99firms.com/blog/whatsapp-statistics/)
- **Ежедневная аудитория** - ~1 млрд. чел (основание сделано исходя из анализа использование на территории США) [[3]](https://backlinko.com/whatsapp-users#whatsapp-statistics)
- **Размер хранилища:** Средний пользователь WhatsApp отправляет более 1200 сообщений в месяц и получает более 2200 сообщений и около 40 фотографий в месяц [[4]](https://news.rambler.ru/internet/39563814/?utm_content=news_media&utm_medium=read_more&utm_source=copylink). Если предположить, что средний размер сообщения — 150 Кбайт (с учетом фотографий), то общий объем отправленных данных за месяц составит около: (150 * (1200 + 2200)) / 1000 = 510 Мб 
- **Среднее количество действий пользователя по типам за период**
Для некоторых действий был использован личный опыт + опыт знакомых и анализ похожих сервисов в целом.

Таблица 2. Соотношение действий и количества их в месяц

Вид действия | Количество/Период
------------ | -------------
Отправка сообщений | 1200 в месяц
Получение сообщений | 2200 в месяц
Приглашение пользователя в чат | 2 в месяц
Создание чата | 0.5 в месяц
Проверка новых сообщений | 690 в месяц
Использование декстопной версии | 24% (от общего количества времени) в месяц
Использование мобильной версии | 76% (от общего количества времени) в месяц

### Технические метрики

- **Размер хранения**
    - Сообщения. Через мессенджер ежедневно отправляется 60 миллиардов сообщений и более 700 миллионов фотографий. Если предположить, что средний размер сообщения — 150 Кбайт, то общий объем отправленных данных составит около 4 330 терабайт [[4]](https://news.rambler.ru/internet/39563814/?utm_content=news_media&utm_medium=read_more&utm_source=copylink).
- **Сетевой трафик**
    - Сообщения (с учетом фотографий и прочего). 150Кб/1000*60.000.000.000/24 = 375.000.000 Гб/час
- **RPS в разбивке по типам запросов**
	- Сообщения. Будем считать, что основная активность общения человека составляет 11 часов в день, то есть 43 200 секунд. Тогда получим следующее значение: 60.000.000.000 / 43.200 = 15.277.768 RPS
	- Создание/удаление чатов. Будем считать, что примерно 0.5 раз для пользователя создается чат. Тогда получим следующее значение: 60.000.000.000 * 0.5 / 43.200 = 697.674 RPS
	- Получение содержимого чатов. Будем считать, что человек примерно 7 раз в день заходит в приложении для получения содержимого. Тогда получим следующее значение: 60.000.000.000 * 7 / 43.200 = 9.722.222 RPS

Таблица 3. Соотношение действий и RPS

Вид действия | RPS
------------ | -------------
Отправка сообщений | 15.277.768
Получение сообщений | 9.722.222
Приглашение пользователя в чат | 697.674
Создание чата | 697.674
Проверка новых сообщений | 9.722.222

# Используемые источники

1. [https://99firms.com/blog/whatsapp-statistics/](https://99firms.com/blog/whatsapp-statistics/)
2. [https://www.statista.com/statistics/814649/whatsapp-users-in-the-united-states-by-age/](https://www.statista.com/statistics/814649/whatsapp-users-in-the-united-states-by-age/)
3. [https://backlinko.com/whatsapp-users#whatsapp-statistics](https://backlinko.com/whatsapp-users#whatsapp-statistics)
4. [https://news.rambler.ru/internet/39563814/?utm_content=news_media&utm_medium=read_more&utm_source=copylink](https://news.rambler.ru/internet/39563814/?utm_content=news_media&utm_medium=read_more&utm_source=copylink)

